# 設定ファイル

# 基本設定
project_name: "yolo11_wide_angle_analysis"  # プロジェクト名
version: "1.0.0"                           # バージョン

# パス設定
paths:
  video_dir: "videos"      # 入力動画ディレクトリ
  model_dir: "models"      # モデル格納ディレクトリ
  output_dir: "outputs"    # 出力ディレクトリ

# モデル設定
models:
  detection: "yolo11n.pt"          # 検出モデルファイル
  pose: "yolo11n-pose.pt"          # ポーズ推定モデルファイル
  tracking_config: "bytetrack.yaml" # トラッキング設定ファイル

# 処理設定
processing:
  frame_sampling:
    interval_sec: 2                # フレーム抽出間隔（秒）
    max_frames: 1000               # 最大フレーム数（メモリ制限対応）

  detection:
    confidence_threshold: 0.3      # 検出信頼度の閾値
    iou_threshold: 0.5             # IoU（重なり度）閾値
    classes: [0]                   # 検出対象クラス（0: person）

  tracking:
    track_thresh: 0.5              # トラッキング信頼度閾値
    track_buffer: 30               # トラッキングバッファサイズ
    match_thresh: 0.8              # トラッキング一致閾値

# 🆕 新規追加: タイル推論設定
  tile_inference:
    enabled: false                    # タイル推論を有効化するかどうか
    tile_size: [640, 640]            # タイルサイズ [width, height]
    overlap_ratio: 0.2               # 重複率 (0.0-1.0)
    max_tiles_per_frame: 16          # 1フレーム当たりの最大タイル数
    use_adaptive: false              # 適応的タイル分割を使用
    nms_threshold: 0.5               # NMS閾値

    # パフォーマンス調整
    memory_efficient_mode: true      # メモリ効率モード
    batch_processing: false          # バッチ処理（現在未実装）

    # 可視化設定
    save_tile_boundaries: false      # タイル境界線の保存
    save_comparison_images: true     # 比較画像の保存

# 評価設定
evaluation:
  metrics:
    basic_metrics: true            # 基本メトリクス評価
    spatial_metrics: true          # 空間メトリクス評価
    temporal_metrics: true         # 時系列メトリクス評価
    quality_metrics: true          # 品質メトリクス評価
    wide_angle_metrics: true       # 広角カメラ特有メトリクス評価
    tile_metrics: true              # タイル推論評価を有効化

  thresholds:
    high_confidence: 0.7           # 高信頼度の閾値
    low_confidence: 0.3            # 低信頼度の閾値
    iou_overlap: 0.5               # IoU重なり閾値
    edge_region_ratio: 0.1         # 画像端領域の割合（例: 10%）

# 実験設定
experiments:
  calibration:
    type: "camera_calibration"     # 実験タイプ：カメラキャリブレーション
    parameters:
      enable_undistortion: true    # 歪み補正を有効化
      calibration_file: "camera_params.json" # 歪み係数等のパラメータファイル

  ensemble:
    type: "model_ensemble"         # 実験タイプ：モデルアンサンブル
    parameters:
      models: ["yolo11n.pt", "yolo11s.pt", "yolo11m.pt"] # 使用するモデル一覧
      voting_strategy: "confidence_weighted"             # 投票方式

  augmentation:
    type: "data_augmentation"      # 実験タイプ：データ拡張
    parameters:
      enable_tta: true             # Test Time Augmentation有効化
      tta_scales: [0.8, 1.0, 1.2] # TTA用スケール
      tta_flips: [false, true]     # TTA用フリップ

      # 🆕 新規追加: タイル推論実験
  tile_comparison:
    type: "tile_inference_comparison"
    parameters:
      compare_with_baseline: true   # ベースラインとの比較
      sample_frames: 10            # 比較用サンプルフレーム数
      tile_sizes: [[640, 640], [800, 800]]  # 比較するタイルサイズ
      overlap_ratios: [0.1, 0.2, 0.3]       # 比較する重複率

# 可視化設定
visualization:
  generate_plots: true            # グラフ生成
  save_annotated_frames: true     # アノテーション付きフレーム保存
  create_summary_video: true      # サマリー動画生成

  # 🆕 新規追加: タイル推論可視化
  tile_visualization:
    show_tile_boundaries: true     # タイル境界の表示
    color_code_by_tile: true      # タイル別色分け
    show_tile_statistics: true    # タイル統計表示
    create_tile_heatmap: false    # タイル使用頻度ヒートマップ（初期値false）

  plot_settings:
    dpi: 300                      # グラフのDPI
    figure_size: [12, 8]          # グラフサイズ
    font_size: 12                 # フォントサイズ

# ロギング設定
logging:
  level: "INFO"                   # ログレベル
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s" # ログフォーマット
  file_handler: true              # ファイル出力有効
  console_handler: true           # コンソール出力有効